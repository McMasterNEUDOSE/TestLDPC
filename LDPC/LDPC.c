#include "LDPC.h"
#include "matrix.h"

static const uint8_t base_graph [NUM_EDGES] = {250, 69, 226, 159, 100, 10, 59, 229, 110, 191, 9, 195, 23, 190, 35, 239, 31, 1, 0, 
                                               2, 239, 117, 124, 71, 222, 104, 173, 220, 102, 109, 132, 142, 155, 255, 28, 0, 0, 0, 
                                               106, 111, 185, 63, 117, 93, 229, 177, 95, 39, 142, 225, 225, 245, 205, 251, 117, 0, 0, 
                                               121, 89, 84, 20, 150, 131, 243, 136, 86, 246, 219, 211, 240, 76, 244, 144, 12, 1, 0, 
                                               157, 102, 0, 205, 236, 194, 231, 28, 123, 115, 0, 183, 22, 28, 67, 244, 11, 157, 211, 0, 
                                               220, 44, 159, 31, 167, 104, 0, 112, 4, 7, 211, 102, 164, 109, 241, 90, 0, 103, 182, 109, 
                                               21, 142, 14, 61, 216, 0, 98, 149, 167, 160, 49, 58, 0, 77, 41, 83, 182, 78, 252, 22, 0};

static const uint16_t rowOffset [BG1_ROWS] = {0, 19, 38, 57, 76, 79, 87, 96, 103, 113, 122, 129};

static const uint8_t rowWeight [BG1_ROWS] = {19, 19, 19, 19, 3, 8, 9, 7, 10, 9, 7, 8};

static const uint8_t columnIndexMap [NUM_EDGES] = {0, 1, 2, 3, 5, 6, 9, 10, 11, 12, 13, 15, 16, 18, 19, 20, 21, 22, 23, 0, 2, 3, 4, 5, 7, 8, 9, 
                                                   11, 12, 14, 15, 16, 17, 19, 21, 22, 23, 24, 0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 17, 18, 19, 
                                                   20, 24, 25, 0, 1, 3, 4, 6, 7, 8, 10, 11, 12, 13, 14, 16, 17, 18, 20, 21, 22, 25, 0, 1, 26, 0, 1, 3, 
                                                   12, 16, 21, 22, 27, 0, 6, 10, 11, 13, 17, 18, 20, 28, 0, 1, 4, 7, 8, 14, 29, 0, 1, 3, 12, 16, 19, 
                                                   21, 22, 24, 30, 0, 1, 10, 11, 13, 17, 18, 20, 31, 1, 2, 4, 7, 8, 14, 32, 0, 1, 12, 16, 21, 22, 23, 33};

static quasi_cyclic_matrix_t H;

quasi_cyclic_matrix_t* get_H () {
    return &H;
}

void LDPC_init () {
    H.rows = BG1_ROWS;
    H.cols = BG1_COLS;
    H.lifting_size = MAX_LIFTING_SIZE; //Subject to change
    
    H.base_graph = base_graph;
    H.rowOffset = rowOffset;
    H.rowWeight = rowWeight;
    H.columnIndexMap = columnIndexMap;
}
